apiVersion: infrastructure.cluster.x-k8s.io/v1alpha1
kind: VCluster
metadata:
  name: k3s-legacy

  namespace: core-prod
spec:
  helmRelease:
    values: |-
      syncer:
        extraArgs:
          - --tls-san=k3s-legacy.resolvemy.host
      controlPlane:
        service:
          # Enabled defines if the control plane service should be enabled
          enabled: true
          labels:
            wan-mode: 'public'
          annotations:
            external-dns.alpha.kubernetes.io/hostname: 'k3s-legacy.resolvemy.host'

  # controlPlaneEndpoint represents the endpoint used to communicate with the control plane.
  # You may leave this field empty, and then CAPVC will try to fill in this information based
  # on the network resources created by the chart (Service, Ingress).
  # The vcluster chart provides options to create a service of LoadBalancer type by setting
  # Helm value - `.service.type: "LoadBalancer"`, or creating an Ingress by setting Helm value
  # `.ingress.enabled: true` and `.ingress.host`. You can explore all options in the charts
  # folder of our vcluster repo - https://github.com/loft-sh/vcluster/tree/main/charts
  #
  # We also recommend reading official vcluster documentation page on this topic:
  # https://www.vcluster.com/docs/operator/external-access
  # this page outlines additional Helm values that you will need to set in certain cases, e.g.
  # `.syncer.extraArgs: ["--tls-san=myvcluster.mydns.abc"]`
  #
  # This field, and all it's sub-fields, are optional.
  controlPlaneEndpoint:
    host: k3s-legacy.resolvemy.host
    port: 443