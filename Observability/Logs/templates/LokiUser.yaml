apiVersion: mylogin.space/v1alpha1
kind: User
metadata:
  name: loki-s3

spec:
  name: Loki {{ .Values.region }}-{{ .Values.datacenter }}-{{ .Values.cluster.name }}

  groups:
    - LDAPService

  s3:
    enabled: true

    createBuckets: true

    createCredentials: true

    crossplane:
      terraformProvider: s3-{{ .Values.region }}-{{ .Values.datacenter }}-core
      crossplaneProvider: s3-{{ .Values.region }}-{{ .Values.datacenter }}-core

    buckets:
      - loki-rules-temp

    writeCredentialsSecretRef:
      name: {{ include "loki.fullname" $.Subcharts.loki }}-s3-creds
      namespace: {{ .Release.Namespace }}

  writeConnectionSecretToRef:
    name: {{ include "loki.fullname" $.Subcharts.loki }}
