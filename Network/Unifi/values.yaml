env: prod

controllers:
  unifi:
    # For Deployments, valid values are Recreate (default) and RollingUpdate.
    # For StatefulSets, valid values are OnDelete and RollingUpdate (default).
    # DaemonSets/CronJobs ignore this.
    strategy: RollingUpdate

    defaultContainerOptions:
      securityContext:
        runAsUser: 999
        runAsGroup: 999

    containers:
      unifi:
        image:
          repository: ghcr.io/goofball222/unifi
          tag: latest-alpine
          pullPolicy: Always

        env:
          - name: DB_MONGO_LOCAL
            value: 'false'

          - name: UNIFI_DB_NAME
            value: 'unifi'

          - name: DB_MONGO_URI
            valueFrom:
              secretKeyRef:
                name: '{{ include "bjw-s.common.lib.chart.names.fullname" $ }}-{{ .Values.env }}'
                key: DB_MONGO_URI

          - name: STATDB_MONGO_URI
            valueFrom:
              secretKeyRef:
                name: '{{ include "bjw-s.common.lib.chart.names.fullname" $ }}-{{ .Values.env }}'
                key: STATDB_MONGO_URI

persistence:
  data:
    enabled: true
    type: persistentVolumeClaim
    mountPath: 
    accessMode: ReadWriteOnce
    size: 2G
    globalMounts:
      - path: /usr/lib/unifi/data
        readOnly: false


  tls:
    enabled: true
    type: secret
    name: myloginspace-default-certificates
    globalMounts:
      - path: /usr/lib/unifi/cert
        readOnly: false